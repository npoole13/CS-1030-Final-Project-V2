<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Decision Tree</title>

  <!-- Bootstrap CSS for styling -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="style.css" rel="stylesheet"> 
</head>
<body class="light-page">

  <!-- Navbar to Navigate between first and second page -->
  <nav id="site-nav" class="navbar navbar-expand-sm navbar-dark bg-dark" role="navigation" aria-label="Main navigation">
    <div class="container">
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#nav" aria-controls="nav"
        aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div id="nav" class="collapse navbar-collapse">
        <div class="navbar-nav">
          <a class="nav-link" aria-current="page" href="index.html">Home</a>
          <a class="nav-link active" href="page2.html">Decision Tree</a>
        </div>
      </div>
    </div>
  </nav>

  <!-- Main container for the decision tree form -->
  <main class="container py-4">
    <h1>Material Selection Decision Tree</h1>

    <!-- Form for material selection -->
    <form name="form1" id="form1">
      Max Temp:
      <select name="Temperature" id="Temperature">
        <option value="" selected="selected">Select Temperature</option>
      </select>

      <br><br>

      Alloys:
      <select name="Alloy" id="Alloy">
        <option value="" selected="selected">Select Alloy</option>
      </select>

      <br><br>

      Strength:
      <select name="Strength" id="Strength">
        <option value="" selected="selected">Select Strength</option>
      </select>

      <br><br>

      <!-- Submit button will calculate final result -->
      <input type="submit" value="Submit">
    </form>

    <!-- Div container is where the final result will display -->
    <div id="result" class="mt-3"></div>
  </main>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    var subjectObject = {
      "200": { // Temperature = 200
        "2xxx": ["200 MPA"],
        "6xxx": ["200 MPA"],
        "7xxx": ["200 MPA"]
      },
      "300": { // Temperature = 300
        "2xxx": ["350 MPA"],
        "6xxx": ["200 MPA"],
        "7xxx": ["350 MPA"]
      }
    }

    window.onload = function () {
      // Get references to the dropdowns and form
      var temperatureSel = document.getElementById("Temperature");
      var alloySel = document.getElementById("Alloy");
      var strengthSel = document.getElementById("Strength");
      var form = document.getElementById("form1");

      // Populates the temperature with keys from what user inputs
      for (var temp in subjectObject) {
        temperatureSel.options[temperatureSel.options.length] = new Option(temp, temp);
      }

      // Update Alloy dropdown with whatever temperature the user inputs
      temperatureSel.onchange = function () {
        alloySel.length = 1; // Reset Alloy dropdown
        strengthSel.length = 1; // Reset Strength dropdown

        // Add alloys based on selected temperature
        for (var alloy in subjectObject[this.value]) {
          alloySel.options[alloySel.options.length] = new Option(alloy, alloy);
        }
      }

      // Updates Strength dropdown when user inputs a different Alloy 
      alloySel.onchange = function () {
        strengthSel.length = 1; // Resets the Strength dropdown

        // Adds strength based on what temperature the user selects and alloy 
        var strengths = subjectObject[temperatureSel.value][this.value];
        for (var i = 0; i < strengths.length; i++) {
          strengthSel.options[strengthSel.options.length] = new Option(strengths[i], strengths[i]);
        }
      }

      // Handles the submission to calculate final result for the user
      form.onsubmit = function (e) {
        e.preventDefault(); // Prevents the page reload

        var temp = temperatureSel.value;
        var alloy = alloySel.value;
        var strength = strengthSel.value;
        var finalResult = "";

        // Check that all options are selected
        if (temp && alloy && strength) {
          // Determines the final aluminum type based on the users selection
          if (temp === "300") {
            if ((alloy === "2xxx" || alloy === "7xxx") && strength === "350 MPA") {
              finalResult = "7075 Aluminum";
            } else if (alloy === "6xxx" && strength === "200 MPA") {
              finalResult = "6061 Aluminum";
            }
          } else if (temp === "200" && strength === "200 MPA") {
            if (alloy === "2xxx" || alloy === "6xxx" || alloy === "7xxx") {
              finalResult = "1100 or 3003 Aluminum";
            }
          }

          // Displays the final result in the #result div container
          document.getElementById("result").innerHTML =
            "<h3>Final Result:</h3><p>" + finalResult + "</p>";
            } else {
                    // Alert user if not all selections are made
                    alert("Please select all options before submitting.");
                }
      }
    }
  </script>

</body>

</html>